<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no">
    <title>ACES Early Results Tour</title>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src='https://aladin.cds.unistra.fr/AladinLite/api/v3/latest/aladin.js' charset='utf-8'></script>
    <!-- Add draggable functionality -->
    <script type="text/javascript" src="draggable.js"></script>
    <script type="text/javascript" src="tour-common.js"></script>
    <link rel="stylesheet" href="default.css">
    <link rel="stylesheet" href="draggable.css">
    <style>
        /* Mobile-friendly improvements */
        #progress-container {
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #progress-bar {
            flex: 1;
            height: 4px !important;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            overflow: hidden;
        }

        #progress {
            height: 100%;
            background: #2962FF;
            transition: width 0.3s ease;
        }

        #current-waypoint {
            color: white;
            font-size: 14px;
            font-weight: bold;
            min-width: 30px;
            text-align: center;
        }

        #tour-controls {
            display: flex;
            gap: 8px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            width: 100%;
            max-width: 100vw;
            box-sizing: border-box;
            padding: 0 10px;
        }

        /* Desktop: only as wide as needed */
        @media (min-width: 769px) {
            #tour-controls {
                width: fit-content;
                padding: 0;
            }
        }

        #tour-controls button {
            background: #2962FF;
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            min-width: 48px;
            min-height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease;
        }

        #tour-controls button:hover {
            background: #1976D2;
        }

        #tour-controls button:active {
            background: #0D47A1;
        }

        #tour-controls button:disabled {
            background: #666;
            color: #999;
            cursor: not-allowed;
        }

        #tour-controls button:disabled:hover {
            background: #666;
        }

        #waypoint-info {
            max-width: 90vw;
            transition: all 0.3s ease;
        }

        /* Override any default positioning for mobile only */
        @media (max-width: 768px) {
            #waypoint-info {
                position: relative !important;
                left: auto !important;
                right: auto !important;
                top: auto !important;
                bottom: auto !important;
                width: fit-content !important;
                max-width: calc(100vw - 20px) !important;
                margin: 10px auto !important;
            }
        }

        /* Desktop: static positioning on top-right */
        @media (min-width: 769px) {
            #waypoint-info {
                position: absolute !important;
                width: auto !important;
                max-width: 400px !important;
                margin: 0 !important;
                left: auto !important;
                right: 20px !important;
                top: 20px !important;
                bottom: auto !important;
                transform: none !important;
                min-width: auto !important;
                max-height: none !important;
                /* Override any flex or grid positioning that might interfere */
                flex: none !important;
                align-self: auto !important;
                justify-self: auto !important;
            }
        }

        #waypoint-header {
            display: flex;
            align-items: center;
            gap: 10px;
            width: fit-content;
        }

                #waypoint-title {
            font-size: 24px;
            margin: 0;
            flex: 0 1 auto;
            line-height: 1.2;
        }

                #expand-btn {
            background: transparent;
            color: white;
            border: none;
            padding: 0;
            cursor: pointer;
            font-size: 14px;
            font-weight: normal;
            transition: opacity 0.2s ease;
            flex-shrink: 0;
            opacity: 0.7;
        }

        #expand-btn:hover {
            opacity: 1;
        }

        #waypoint-content {
            margin-top: 10px;
        }

        #waypoint-description {
            font-size: 16px;
            line-height: 1.4;
            margin: 0;
        }

                /* Mobile specific adjustments */
        @media (max-width: 768px) {
            #tour-controls {
                gap: 6px;
                padding: 0 5px;
            }

            #tour-controls button {
                padding: 12px 14px;
                font-size: 18px;
                min-width: 46px;
                min-height: 46px;
                flex: 0 1 auto;
            }

            #waypoint-dropdown {
                width: 32px !important;
                padding: 12px 4px !important;
                font-size: 14px !important;
            }

            #speed-dropdown {
                width: 38px !important;
                padding: 12px 4px !important;
                font-size: 14px !important;
            }

                        #waypoint-info {
                padding: 20px 15px;
                margin: 10px auto !important;
                max-width: calc(100vw - 20px);
                position: relative !important;
                left: auto !important;
                right: auto !important;
                top: auto !important;
                bottom: auto !important;
                width: fit-content !important;
            }

            #waypoint-info.collapsed #waypoint-content {
                display: none;
            }

            #waypoint-info.expanded {
                position: fixed !important;
                top: 10px !important;
                left: 10px !important;
                right: 10px !important;
                bottom: auto !important;
                max-height: 70vh;
                overflow-y: auto;
                z-index: 1000;
                background: rgba(0, 0, 0, 0.9);
                border-radius: 12px;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
                width: auto !important;
                margin: 0 !important;
            }

                        #waypoint-title {
                font-size: 28px;
                font-weight: bold;
            }

            #waypoint-description {
                font-size: 16px;
            }

            #expand-btn {
                font-size: 16px;
            }
        }

        /* Very narrow screens (iPhone SE, etc.) */
        @media (max-width: 400px) {
            #tour-controls {
                gap: 4px;
                padding: 0 3px;
            }

            #tour-controls button {
                padding: 10px 12px;
                font-size: 16px;
                min-width: 40px;
                min-height: 40px;
                flex: 1 1 auto;
                max-width: 60px;
            }

            #waypoint-dropdown {
                width: 28px !important;
                padding: 10px 2px !important;
                font-size: 12px !important;
                flex: 0 0 28px;
            }

            #speed-dropdown {
                width: 32px !important;
                padding: 10px 2px !important;
                font-size: 12px !important;
                flex: 0 0 32px;
            }

            #progress-container {
                margin: 0 3px 8px 3px;
                padding: 6px 10px;
            }

                        #waypoint-info {
                margin: 10px auto !important;
                padding: 18px 12px;
                max-width: calc(100vw - 15px);
                position: relative !important;
                left: auto !important;
                right: auto !important;
                top: auto !important;
                bottom: auto !important;
                width: fit-content !important;
            }

            #waypoint-info.expanded {
                top: 5px !important;
                left: 5px !important;
                right: 5px !important;
                max-height: 75vh;
                padding: 15px;
                margin: 0 !important;
            }

                        #waypoint-title {
                font-size: 24px;
                font-weight: bold;
            }

            #waypoint-description {
                font-size: 15px;
            }

            #expand-btn {
                font-size: 14px;
            }
        }

        /* Countdown Timer */
        #countdown-timer {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: bold;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        #countdown-value {
            color: #2962FF;
            font-size: 16px;
        }

        @media (max-width: 768px) {
            #countdown-timer {
                bottom: 10px;
                right: 10px;
                font-size: 12px;
                padding: 6px 10px;
            }

            #countdown-value {
                font-size: 14px;
            }
        }
    </style>
</head>

<body>
    <div id="aladin-lite-div"></div>

    <div id="loading-div">Loading ACES Star Formation Tour... Please wait.</div>

    <div id="waypoint-info">
        <div id="waypoint-header">
            <button id="expand-btn" title="Expand/Collapse Info">▶</button>
            <h2 id="waypoint-title">Welcome to the ACES Early Results Tour</h2>
        </div>
        <div id="waypoint-content">
            <p id="waypoint-description">
            This tour highlights key early discoveries from the ALMA Central Molecular Zone Exploration Survey (ACES), including a supernova-disrupted molecular cloud and a mysterious ultra-broad-line object.  Click "Start Tour" to begin.
            </p>
        </div>
    </div>

    <div id="progress-container">
        <div id="progress-bar">
            <div id="progress"></div>
        </div>
        <span id="current-waypoint">0</span>
    </div>

    <div id="tour-controls">
        <button id="prev-btn" title="Previous">‹</button>
        <button id="next-btn" title="Next">›</button>
        <button id="start-btn" title="Start/Play Tour">▶</button>
        <button id="reset-btn" title="Reset">⟲</button>
        <button id="share-btn" title="Copy shareable link to current waypoint">🔗</button>
        <select id="waypoint-dropdown" title="Jump to waypoint"
            style="background-color: #2962FF; color: white; border: none; padding: 12px 6px; border-radius: 8px; margin: 0 3px; cursor: pointer; font-size: 16px; position: relative; z-index: 120; width: 36px; text-align: center; -webkit-appearance: none; -moz-appearance: none; appearance: none;">
            <option value="">≫</option>
        </select>
        <select id="speed-dropdown" title="Tour speed: 1× = normal, 2× = double speed, 4× = quadruple speed"
            style="background-color: #2962FF; color: white; border: none; padding: 12px 6px; border-radius: 8px; margin: 0 3px; cursor: pointer; font-size: 16px; position: relative; z-index: 120; width: 42px; text-align: center; -webkit-appearance: none; -moz-appearance: none; appearance: none;">
            <option value="1" selected>1×</option>
            <option value="2">2×</option>
            <option value="4">4×</option>
        </select>
    </div>

    <div id="countdown-timer" style="display: none;">
        <span id="countdown-text">Next in: </span>
        <span id="countdown-value">5</span>
    </div>

    <script>
        // Define waypoints for the ACES Early Results tour
        const waypoints = [
            {
                ra: 266.416667,
                dec: -29.008333,
                fov: 3.0,
                transition_fov: 3.0,
                transition_time: 2,
                zoom_out_time: 0,
                zoom_in_time: 2,
                title: "The Central Molecular Zone",
                description: "The Central Molecular Zone (CMZ) of our Galaxy seen with MEERKAT and Spitzer. This extreme environment, 200 parsecs around our Galaxy's supermassive black hole, harbors unique phenomena impossible to study elsewhere. Color composite by Ashley Barnes.",
                url: getImageUrl("rgb_final_uncropped_hips"),
                pause_time: 6000
            },
            {
                ra: 266.416667,
                dec: -29.008333,
                fov: 0.8,
                transition_fov: 3.0,
                transition_time: 3,
                zoom_out_time: 2,
                zoom_in_time: 3,
                title: "ACES Survey",
                description: "The ALMA Central Molecular Zone Exploration Survey (ACES) combined with the Green Bank Telescope's MUSTANG survey. This comprehensive survey has revealed unprecedented details of molecular gas dynamics and star formation in the Galactic Center, enabling the discovery of exotic objects impossible to find anywhere else.",
                url: getImageUrl("MUSTANG_12m_feather_noaxes_hips/"),
                is_sticky: true,
                fade_out_time: 1.5,
                fade_delay: 0.5,
                fade_in_time: 1.5,
                pause_time: 6000
            },
            {
                ra: 267.07262318,
                dec: -28.3559128,
                fov: 0.2,
                transition_fov: 0.8,
                transition_time: 4,
                zoom_out_time: 2,
                zoom_in_time: 4,
                title: "The M0.8-0.2 Ring: A Supernova's Legacy",
                description: "This remarkable ring-shaped molecular cloud was discovered by Nonhebel et al. (2024) in ACES data. With inner and outer radii of 3.1 and 6.1 parsecs, this structure contains ~10⁶ solar masses of gas expanding at ~20 km/s. The team proposes this is the remnant of a hypernova explosion that disrupted a massive molecular cloud, providing an extreme example of stellar feedback in the CMZ. Citation: Nonhebel et al. 2024, A&A, 691, A70",
                url: getImageUrl("MUSTANG_12m_feather_noaxes_hips/"),
                fade_layer: getImageUrl("rgb_final_uncropped_hips"),
                pause_time: 8000
            },
            {
                ra: 266.416667,
                dec: -29.008333,
                fov: 0.8,
                transition_fov: 0.8,
                transition_time: 3,
                zoom_out_time: 2,
                zoom_in_time: 3,
                title: "Back to ACES Overview",
                description: "Returning to the full ACES field of view to contextualize our next discovery - a mysterious compact object with extraordinarily broad molecular line emission.",
                url: getImageUrl("MUSTANG_12m_feather_noaxes_hips/"),
                pause_time: 4000
            },
            {
                ra: 266.49059351,
                dec: -28.95297275,
                fov: 0.02,
                transition_fov: 0.8,
                transition_time: 5,
                zoom_out_time: 3,
                zoom_in_time: 5,
                title: "The MUBLO: G0.02467-0.0727",
                description: "The Millimeter Ultra-Broad-Line Object (MUBLO) discovered by Ginsburg et al. (2024) is unlike anything previously observed. This compact source (≲10⁴ AU) exhibits molecular line emission with extreme velocities (~160 km/s FWHM) in CS, SO, and SO₂ transitions, yet shows no signs of strong shocks. Despite extensive modeling, its nature remains a mystery - possibly representing an entirely new class of astrophysical object. Citation: Ginsburg et al. 2024, ApJL, 968, L11",
                url: getImageUrl("MUSTANG_12m_feather_noaxes_hips/"),
                fade_layer: getImageUrl("rgb_final_uncropped_hips"),
                pause_time: 10000
            },
            {
                ra: 266.835223,
                dec: -28.3958813,
                fov: 0.1,
                transition_fov: 0.8,
                transition_time: 4,
                zoom_out_time: 2,
                zoom_in_time: 4,
                title: "Sgr B2 Context",
                description: "For comparison, here is the well-studied Sagittarius B2 complex - our Galaxy's most massive star-forming region. The ACES survey, combined with earlier ALMA observations (Ginsburg et al. 2018), provides crucial context for understanding both normal and exotic objects in the CMZ.",
                url: getImageUrl("feathered_MGPS_ALMATCTE7m_hips/"),
                fade_layer: getImageUrl("MUSTANG_12m_feather_noaxes_hips/"),
                pause_time: 6000
            },
            {
                ra: 266.416667,
                dec: -29.008333,
                fov: 2.0,
                transition_fov: 2.0,
                transition_time: 4,
                zoom_out_time: 3,
                zoom_in_time: 2,
                title: "ACES: Revealing the Extreme Universe",
                description: "The ACES survey continues to reveal the extreme physics at play in our Galaxy's center. From supernova-disrupted molecular clouds to mysterious ultra-broad-line objects, these discoveries demonstrate how unique environments can produce phenomena impossible to study elsewhere in the cosmos. As the survey progresses, we expect many more surprises from this remarkable laboratory of extreme astrophysics.",
                url: getImageUrl("rgb_final_uncropped_hips"),
                fade_layer: getImageUrl("MUSTANG_12m_feather_noaxes_hips/"),
                pause_time: 8000
            }
        ];

        // Initialize the tour when the page is loaded
        document.addEventListener('DOMContentLoaded', function () {
            initializeTour(waypoints, {
                initialSurvey: 'rgb_final_uncropped_hips/'
            });
        });
    </script>
</body>

</html>